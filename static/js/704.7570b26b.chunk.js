"use strict";(self.webpackChunksn_ts=self.webpackChunksn_ts||[]).push([[704],{1704:function(e,n,a){a.r(n),a.d(n,{default:function(){return x}});var t=a(2982),s=a(885),r=a(2791),o="ChatPage_container__9eu1w",c="ChatPage_messagesBlock__5O-4U",l="ChatPage_message__SygNn",u="ChatPage_photo__uHi72",i="ChatPage_textBlock__tsRcz",d="ChatPage_userName__OhCYX",h="ChatPage_text__BOeIM",_="ChatPage_inputBlock__FaoDM",m="ChatPage_textarea__46QJW",v="ChatPage_button__JKvr0",f=a(3429),g=a(184);var x=function(){var e,n=(0,r.useState)(""),a=(0,s.Z)(n,2),x=a[0],C=a[1],p=(0,r.useState)([]),N=(0,s.Z)(p,2),j=N[0],P=N[1],k=(0,r.useState)(""),S=(0,s.Z)(k,2),E=S[0],w=S[1],b=(0,r.useState)(null),Z=(0,s.Z)(b,2),y=Z[0],O=Z[1],L=(0,r.useState)("pending"),B=(0,s.Z)(L,2),T=B[0],W=B[1],D=(0,r.useRef)(null);y&&(y.onmessage=function(e){P([].concat((0,t.Z)(j),(0,t.Z)(JSON.parse(e.data)))),D.current&&D.current.scrollTo(0,D.current.scrollHeight)}),(0,r.useEffect)((function(){var e,n,a=function(){console.log("WS WAS CLOSED"),w("reconnect..."),n=setTimeout(t,3e3)},t=function(){w(""),(e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx")).addEventListener("close",a),O(e)};return t(),function(){e.removeEventListener("close",a),e.close(),clearTimeout(n)}}),[]),(0,r.useEffect)((function(){var e=function(){console.log("OPEN"),W("ready")};return null===y||void 0===y||y.addEventListener("open",e),function(){return null===y||void 0===y?void 0:y.removeEventListener("open",e)}}),[y]);var H=function(){x&&(null===y||void 0===y||y.send(x),C(""))};return(0,g.jsxs)("div",{className:o,children:[(0,g.jsx)("div",{ref:D,className:c,children:j.map((function(e,n){return(0,g.jsxs)("div",{className:l,children:[(0,g.jsx)("img",{className:u,src:e.photo?e.photo:f,alt:"userPhoto"}),(0,g.jsxs)("div",{className:i,children:[(0,g.jsx)("span",{className:d,children:e.userName}),(0,g.jsx)("span",{className:h,children:e.message})]})]},n)}))}),(0,g.jsxs)("div",{className:_,children:[(0,g.jsx)("textarea",{value:x,onChange:function(e){C(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&H()},className:m,name:"textarea",id:"textarea"}),(0,g.jsx)("label",{htmlFor:"textarea",children:"write your message here"}),(0,g.jsx)("button",{onClick:H,disabled:null==y||"ready"!==T,className:v,children:"send"}),E&&(0,g.jsxs)("span",{children:[E,null===y||void 0===y||null===(e=y.onerror)||void 0===e?void 0:e.name]})]})]})}}}]);
//# sourceMappingURL=704.7570b26b.chunk.js.map